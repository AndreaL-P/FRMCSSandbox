sequenceDiagram
  participant A as OB interoperable DATA app
  participant O as OB FRMCS - Service Client
  participant M1 as MC server IM1
  participant T1 as TS GW IM1
  participant B1 as TS interoperable DATA app 1 - Service Client
  participant M2 as MCX server IM2
  participant T2 as TS GW IM2
  participant B2 as TS interoperable DATA app 2 - Service Client
  participant P1 as New Participant

  par TS1 setup
    Note over B1, T1: TSapp local binding (DynamicID=D2)
    Note over T1: Service Choice (MC, Other Service TbD)
    Note over T1, M1: MC1 registration
  and TS2 setup
    Note over B2, T2: TSapp local binding (DynamicID=D3)
    Note over T2: Service Choice (MC, Other Service TbD)
    Note over T2, M2: MC2 registrationand TS2 setup
  and OB setup
    Note over O: Start of Operation
    Note over A, O: OBapp local binding (DynamicID=D1)
    Note over O: Service Choice (MC, Other Service TbD)
    Note over O, M1: MC1 registration
  end
  rect rgb(191, 223, 255)
    Note over A, B1: Applicative Session (with given dest. applicative ID AS1 OB side, AS3 TS side)  OB DATA app ↔ TS DATA app 1 (IPe ↔ IPr1) over Domain 1
    Note over O: Resolution of Applicative dest. ID to Service dest. ID
    Note over O, T1: Service Session (SS1 OB side, SS3 TS side)<br/>OB DATA app ↔ TS DATA app 1 (IPe ↔ IPr1)<br/>over Domain 1
  end
  Note over A: applicative HO_Request_With_Make_Before_Break_Constraint (TS DATA app 2 with given dest. applicative ID)
  rect rgb(191, 223, 255)
    A ->> O: POST /sessions/{DynamicID=D1} (localAppIPAddress=IPe,recipients=[TS DATA app 2 dest. applicative ID])
    Note over O: Resolution of Applicative dest. ID to Service dest. ID
    par Initial answer
      O ->> A: 200 OK [initial answer] (SessionID=AS2)
    and Session establishment via Interconnection over FSnni(as per FU 7120 11.4.4.11 for ATP or 11.5.4.10 for ATO)
      Note over A, B2: establishment of Applicative Session AS2<br/>OB DATA app 1 ↔ TS DATA app 2 connection (IPe ↔ IPr2)
      Note over O, T2: Service Session SS2 MCdata<br/>OB FRMCS ↔ MCX1 ↔ MCX2 ↔ TS GW2<br/>via Interconnection (as per FU 7120 11.4.4.11 for ATP or 11.5.4.10 for ATO)
      O ->> M1: MC session establishment request to IM2 MC Client
      M1 ->> T2: MC session establishment request to IM2 MC client
      T2 -->> B2: SSE Incoming Session (SessionID=AS4)
      B2 ->> T2: PUT /sessions/{DynamicID=D3}/{SessionID=AS4} (localAppIPAddress=IPr2)
      T2 ->> B2: 200 OK
      T2 ->> M1: incoming session accepted (TS SS4)
      M1 ->> O: incoming session accepted (OB SS2)
      O -->> A: SSE Final answer (SessionID=AS2,remoteAppIPAddress=IPr2)
    end
  end
  rect rgb(191, 223, 255)
    Note over A, B1: ← end connection with TS DATA app 1
    A ->> O: DELETE /sessions/{DynamicID=D1}/{SessionID=AS1}
    par ack to OB DATA app 1
      O ->> A: 200 OK
    and closure towards TS
      Note over O, T1: MCdata termination [TS DATA app 1]
      T1 -->> B1: SSE closure (SessionID=AS3)
    end
    Note over A, B1: → ended connection with TS DATA app 1
  end
  Note over O: NTT to move to Transport Domain 2<br/>(note that NTT can -and probably shall- be ran coverage based)
  O -->> A: SSE_FSD_NAVL
  Note over O: Service Choice (MC, Other Service TbD)
  Note over O, M2: Acquisition of Domain 2 (OB Service Client to Service server)
  rect rgb(240, 223, 255)
    critical Recovery of Service Session (S3 OB side S4 TS side)
      Note over O, T2: MCdata OB FRMCS ↔ MCX2 ↔ TS GW2
      O -->> T2: Session Replacement (OldSessionID=SS4)
      T2 -->> O: 200 OK
      Note over O, T2: Replacement of Session SS2 OB side ↔ SS4 TS
    end
  end
  O -->> A: SSE FSD_AVL [Domain2]


